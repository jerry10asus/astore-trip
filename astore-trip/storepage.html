<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <meta name="theme-color" content="#ffffff" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <meta name="apple-mobile-web-app-title" content="AStore Trip" />
  <title>AStore Trip - 門市資訊</title>
  <link rel="icon" type="image/png" href="./assets/app_icon.png" />
  <link rel="apple-touch-icon" href="./assets/app_icon.png" />
  <link rel="manifest" href="./manifest.webmanifest" />
  <link rel="stylesheet" href="./css/base.css" />
  <link rel="stylesheet" href="./css/glass.css" />
  <link rel="stylesheet" href="./css/layout.css" />
  <link rel="stylesheet" href="./css/pwa-update.css" />
  <link rel="stylesheet" href="./css/pwa-install.css" />
</head>
<body>
  <!-- Header - 透明效果，覆盖在图片上 -->
  <header class="store-header">
    <a class="back-btn" href="./stores.html" aria-label="返回">
      <img src="./assets/icon/arrow_left.svg" alt="返回" class="back-icon" />
    </a>
    <button class="favorite-header-btn" id="headerFavoriteBtn" aria-label="收藏">
      <img src="./assets/icon/favorites.svg" alt="收藏" class="favorite-icon" id="headerFavoriteIcon" />
    </button>
  </header>

  <main class="storepage-main">
    <!-- Hero 圖輪播 -->
    <section class="store-hero">
      <div class="carousel-container" id="carouselContainer">
        <!-- 圖片區域 Loading 遮罩 -->
        <div class="carousel-loading" id="carouselLoading">
          <div class="loading-spinner"></div>
          <div class="loading-text">載入中...</div>
        </div>
        <div class="carousel-track" id="carouselTrack">
          <!-- 圖片將由 JavaScript 動態生成 -->
        </div>
      </div>
      <div class="carousel-indicators" id="carouselIndicators">
        <!-- 指示器將由 JavaScript 動態生成 -->
      </div>
    </section>

    <!-- 商店名稱和位置 -->
    <section class="store-title-section">
      <h2 id="storeName" class="store-name">信義 A13</h2>
      <p class="store-location">
        <span class="pin-icon">📍</span>
        <span id="storeLocation">台灣, 台北</span>
      </p>
    </section>

    <!-- 打卡按鈕 -->
    <section class="checkin-section">
      <button id="btnCheckin" class="checkin-btn">
        <span class="checkin-icon">📍</span>
        <span class="checkin-text">在此打卡</span>
      </button>
      <div class="checkin-success" id="checkinSuccess" style="display: none;">
        <div class="checkin-success-row">
          <button class="checkin-btn checkin-btn-success">
            <span class="checkin-icon">✓</span>
            <span class="checkin-text">打卡成功</span>
          </button>
          <button id="btnVerifyLocation" class="verify-location-btn" style="display: none;" aria-label="驗證定位">
            <img src="./assets/icon/gpscheck.svg" alt="驗證定位" class="verify-icon" />
          </button>
        </div>
        <p class="checkin-date" id="checkinDate">
          <span id="checkinDateText"></span>
          <img id="verifiedBadge" src="./assets/icon/badge.svg" alt="驗證成功" class="verified-badge" style="display: none;" />
        </p>
      </div>
    </section>

    <!-- Toast 提示 -->
    <div class="toast" id="toast" style="display: none;">
      <span id="toastMessage"></span>
    </div>

    <!-- 恭喜獲得勳章彈窗 -->
    <div class="medal-congrats-modal" id="medalCongratsModal" style="display: none;">
      <div class="medal-congrats-backdrop"></div>
      <div class="medal-congrats-content">
        <h3 class="medal-congrats-title">恭喜獲得新勳章！</h3>
        <div class="medal-congrats-medal" id="medalCongratsMedal">
          <!-- 勳章將由 JavaScript 動態生成 -->
        </div>
        <p class="medal-congrats-name" id="medalCongratsName"></p>
        <div class="medal-congrats-actions">
          <button class="medal-congrats-btn secondary" id="medalCongratsClose">我知道了</button>
          <button class="medal-congrats-btn primary" id="medalCongratsView">查看成就</button>
        </div>
      </div>
    </div>

    <!-- 商店描述 -->
    <section class="store-description">
      <p id="storeDesc">這裡是門市描述的佔位文字，介紹門市特色與空間設計。</p>
    </section>

    <!-- 聯絡電話 -->
    <section class="store-contact">
      <div class="info-row">
        <h3 class="section-label">聯絡電話</h3>
        <p class="contact-phone" id="storePhone">0800-020-010</p>
      </div>
    </section>

    <!-- 營業時間 -->
    <section class="store-hours-section">
      <div class="info-row">
        <div class="section-label-wrapper">
          <h3 class="section-label">營業時間</h3>
          <p class="hours-note">實際營業時間依官網為主</p>
        </div>
        <div class="hours-list" id="storeHours">
          <div class="hours-item">星期一 11:00-21:30</div>
          <div class="hours-item">星期二 11:00-21:30</div>
          <div class="hours-item">星期三 11:00-21:30</div>
          <div class="hours-item">星期四 11:00-21:30</div>
          <div class="hours-item">星期五 11:00-21:30</div>
          <div class="hours-item">星期六 11:00-21:30</div>
          <div class="hours-item">星期日 11:00-21:30</div>
        </div>
      </div>
    </section>

    <!-- 門市地址 -->
    <section class="store-address-section">
      <div class="info-row">
        <h3 class="section-label">門市地址</h3>
        <div class="address-content">
          <p class="store-address" id="storeAddress">台北市信義區松壽路13號</p>
          <a id="btnNavigate" class="navigate-btn" href="#" target="_blank" rel="noopener">前往</a>
        </div>
      </div>
    </section>

    <!-- 地圖 -->
    <section class="store-map-section">
      <div class="store-map liquid-glass" id="storeMapContainer">
        <!-- Google Map iframe 將由 JavaScript 動態生成 -->
      </div>
    </section>
  </main>

  <script src="./js/data.js"></script>
  <script src="./js/storeDetail.js"></script>
  <script src="./js/pwa-update.js"></script>
  <script src="./js/pwa-install.js"></script>
  <script>
    // Register Service Worker for PWA
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./sw.js')
          .then(reg => console.log('Service Worker registered:', reg))
          .catch(err => console.error('Service Worker registration failed:', err));
      });
    }

    if (window.StoreDetailPage) {
      window.StoreDetailPage.init();
    }
  </script>
</body>
</html>
